/**
 * selectKit - A jQuery plugin that makes select boxes look nicer.
 * @version v0.0.1
 * @link http://github.com/aslansky/selectkit
 * @license MIT
 */
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";var e={},i=function(){function t(){this.options_index=0,this.parsed=[]}return t.prototype.add_node=function(t){return"OPTGROUP"===t.nodeName.toUpperCase()?this.add_group(t):this.add_option(t)},t.prototype.add_group=function(t){var e,i,s,n,c,o;for(e=this.parsed.length,this.parsed.push({array_index:e,group:!0,label:this.escapeExpression(t.label),children:0,disabled:t.disabled}),c=t.childNodes,o=[],s=0,n=c.length;n>s;s++)i=c[s],o.push(this.add_option(i,e,t.disabled));return o},t.prototype.add_option=function(t,e,i){return"OPTION"===t.nodeName.toUpperCase()?(""!==t.text?(null!=e&&(this.parsed[e].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:t.value,text:t.text,html:t.innerHTML,selected:t.selected,disabled:i===!0?i:t.disabled,group_array_index:e,classes:t.className,style:t.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},t.prototype.escapeExpression=function(t){var e,i;return null==t||t===!1?"":/[\&\<\>\"\'\`]/.test(t)?(e={"<":"&lt;",">":"&gt;",'""':"&quot;","'":"&#x27;","`":"&#x60;"},i=/&(?!\w+;)|[\<\>\"\'\`]/g,t.replace(i,function(t){return e[t]||"&amp;"})):t},t}();i.select_to_array=function(t){var e,s,n,c,o;for(s=new i,o=t.childNodes,n=0,c=o.length;c>n;n++)e=o[n],s.add_node(e);return s.parsed};var s=function(t,e){var i=this;s.isBrowserSupported()&&(this.clickTestAction=function(t){return s.testActive(t,i)},this.settings=e,this.$select=t,this.$container=null,this.open=!1,this.settings.multi=!!this.$select.attr("multiple"),this.settings.placeholder||(this.settings.placeholder=this.$select.attr("placeholder")||"&nbsp;"),this.render(),this.initEvents())};s.prototype.render=function(){this.$select.wrap('<div class="selectkit"></div>'),this.$container=this.$select.parent(),this.$select.width()&&this.$select.width()>0&&this.$container.width(this.$select.width()),this.$container.append('<div class="selectkit-display"><span>'+this.settings.placeholder+'</span><i class="selectkit-caret"></i></div>'),this.$display=t(".selectkit-display",this.$container),this.$text=t("span",this.$display),this.$container.append('<div class="selectkit-list"></div>'),this.$dropdown=t(".selectkit-list",this.$container),this.settings.search&&this.$dropdown.append('<div class="selectkit-search"><input type="text" name="selectkit-search"></div>'),this.$dropdown.append('<ul class="selectkit-choices"></ul>'),this.$list=t(".selectkit-choices",this.$container),this.$choices=this.renderList()},s.prototype.renderList=function(){var e=this;return this.data=i.select_to_array(this.$select.get(0)),t.each(this.data,function(){this.group?e.renderGroup(this):e.renderOption(this)}),t(".selectkit-choice",this.$container)},s.prototype.renderGroup=function(e){var i=t('<li class="selectkit-group">'+e.label+"</li>");i.data().data=e,this.$list.append(i)},s.prototype.renderOption=function(e){if(e.empty)this.empty_choice=e,this.settings.reset&&this.$display.append('<i class="selectkit-reset selectkit-reset-disabled"></i>');else{var i=t('<li class="selectkit-choice">'+e.html+"</li>");this.settings.multi&&this.settings.checkbox&&i.prepend('<input type="checkbox" class="selectkit-check">'),e.disabled&&(i.find("input").prop("disabled",!0),i.addClass("selectkit-disabled")),e.$ele=i,i.data().data=e,this.$list.append(i)}},s.prototype.initEvents=function(){var e=this;t(".selectkit-display",this.$container).bind("mousedown.selectkit",function(t){e.toggleDropdown(t)}),t(".selectkit-reset",this.$container).bind("mouseup.selectkit",function(){e.reset()}),this.$choices.bind("mouseup.selectkit",function(t){e.choiceMouseup(this,t)})},s.prototype.toggleDropdown=function(t){t.stopPropagation(),this.open?this.hide():this.show()},s.prototype.show=function(){this.$dropdown.show(),this.open=!0,this.$container.addClass("selectkit-open"),this.$container.addClass("selectkit-active"),t(document).bind("click.selectkit",this.clickTestAction)},s.prototype.hide=function(){this.$dropdown.hide(),this.open=!1,this.$container.removeClass("selectkit-open"),this.$container.removeClass("selectkit-active"),t(document).unbind("click.selectkit",this.clickTestAction)},s.prototype.choiceMouseup=function(e,i){var s=t(e);s.data().data.disabled||(this.settings.multi&&s.hasClass("selectkit-selected")?this.deSelectChoice(s.data().data,"INPUT"===i.target.nodeName):this.selectChoice(s.data().data,"INPUT"===i.target.nodeName))},s.prototype.selectChoice=function(t,e){!this.settings.multi&&this.$choices.filter(".selectkit-selected").length&&this.deSelectChoice(this.$choices.filter(".selectkit-selected").data().data),t.$ele.addClass("selectkit-selected"),t.selected=!0,this.$select.find("option").get(t.options_index).selected=!0,this.settings.multi&&this.settings.checkbox&&!e&&t.$ele.find("input").prop("checked",!0),this.$choices.filter(".selectkit-selected").length&&this.$display.find(".selectkit-reset").removeClass("selectkit-reset-disabled"),(this.settings.hideOnSelect||!this.settings.multi)&&this.hide(),this.setText()},s.prototype.deSelectChoice=function(t,e){t.$ele.removeClass("selectkit-selected"),t.selected=!1,this.$select.find("option").get(t.options_index).selected=!1,this.settings.multi&&this.settings.checkbox&&!e&&t.$ele.find("input").prop("checked",!1),this.$choices.filter(".selectkit-selected").length||this.$display.find(".selectkit-reset").addClass("selectkit-reset-disabled"),(this.settings.hideOnSelect||!this.settings.multi)&&this.hide(),this.setText()},s.prototype.setText=function(){var t=this.$choices.filter(".selectkit-selected");this.$text.html(1===t.length?t.data().data.html:t.length>1?t.data().data.html+" and "+(t.length-1)+" others selected":this.settings.placeholder)},s.prototype.reset=function(){this.$select.find(":selected").each(function(){this.selected=!1}),this.$select.find("option").get(this.empty_choice.options_index).selected=!0,this.$list.find(".selectkit-selected").removeClass("selectkit-selected"),this.$choices.find("input").prop("checked",!1),this.$display.find(".selectkit-reset").addClass("selectkit-reset-disabled"),this.hide()},s.prototype.destroy=function(){this.$select.show(),this.$container.before(this.$select),this.$container.remove()},s.testActive=function(e,i){var s=t(e.target).closest(".selectkit");return s.length&&i.$container.get(0)===s.get(0)?!0:(i.hide(),!1)},s.isBrowserSupported=function(){return"Microsoft Internet Explorer"===window.navigator.appName?document.documentMode>=8:/iP(od|hone)/i.test(window.navigator.userAgent)?!1:/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)?!1:!0},t.fn.selectKit=function(i){if(!s.isBrowserSupported())return this;var n=t.extend({},e,i);return this.each(function(){var e=t(this);void 0===i||t.isPlainObject(i)?e.data("selectkit",new s(e,t.extend({},n,e.data()))):e.data().selectkit&&e.data().selectkit[i].call(e.data().selectkit)})}});